(()=>{"use strict";class e{constructor(e,t="No due date"){this.name=e,this.date=t}setName(e){this.name=e}setDate(e){this.date=e}getName(){return this.name}getDate(){return this.date}getDateFormatted(){this.date.split("/")[0],this.date.split("/")[1],this.date.split("/")[2]}}class t{constructor(e){this.name=e,this.tasks=[]}addTask(e){this.tasks.push(e)}deleteTask(e){for(let t=0;t<this.tasks.length;t++)if(e==this.tasks[t].name){let e=this.tasks.slice(0,t),s=this.tasks.slice(t+1),n=e.concat(s);this.tasks=n}}getTasks(){return this.tasks}setTasks(e){this.tasks=e}getName(){return this.name}setName(e){this.name=e}}class s{constructor(e,t,s="No due date"){this.name=e,this.projectName=t,this.date=s}}let n=document.getElementById("inboxButton"),a=document.getElementById("display"),d=document.getElementById("projectsSidebar"),i=document.querySelectorAll(".sidebarButton"),c=new t("Inbox"),l=document.getElementById("addProject"),o=document.getElementById("addProjectContainer"),r=document.getElementById("addProjectOpen"),m=document.getElementById("cancelAddProject"),u=document.getElementById("newProjectName"),h=document.querySelectorAll(".projectSidebar"),g=new class{constructor(){this.list=[]}addProject(e){this.list.push(e)}deleteProject(e){for(let t=0;t<this.list.length;t++)if(e==this.getList()[t].name){let e=this.getList().slice(0,t),s=this.getList().slice(t+1),n=e.concat(s);this.list=n}}getList(){return this.list}setList(e){this.list=e}getStorage(){this.setList(JSON.parse(localStorage.getItem("projects")))}setStorage(){localStorage.setItem("projects",JSON.stringify(this.list))}};g.addProject(c);let k,L=document.getElementById("addTaskOpen"),E=document.getElementById("addTaskContainer"),p=document.getElementById("cancelAddTask"),v=document.getElementById("addTask"),y=document.getElementById("newTaskName"),f=document.querySelectorAll(".checkbox"),T=document.querySelectorAll(".taskDate"),I=document.getElementById("projectTitle"),S=document.getElementById("todayButton"),j=document.querySelectorAll(".deleteProject");function B(){d.innerHTML="";for(let e=1;e<g.getList().length;e++)d.innerHTML+=`<div id = ${g.getList()[e].name} class = projectSidebar>`+g.getList()[e].name+'<button class = "deleteProject hidden">X</button></div>',h=document.querySelectorAll(".projectSidebar");j=document.querySelectorAll(".deleteProject"),h.forEach((e=>{e.addEventListener("mouseover",(()=>{j.forEach((t=>{e.contains(t)?t.classList.remove("hidden"):t.classList.add("hidden")}))}))})),j.forEach((e=>{e.addEventListener("click",(()=>{var t;t=e.parentElement.id,g.getList().forEach((e=>{e.name==t&&(g.deleteProject(t),g.setStorage(),B())}))}))}))}function b(t){let s=A(t);console.log("func"),a.innerHTML="",a.innerHTML+='<h2 id = "projectTitle">'+s.name+"</h2><div id = 'taskContainer'></div>",k=document.getElementById("taskContainer"),N(s),a.innerHTML+='<div class="hidden" id = "addTaskContainer">'+E.innerHTML+'</div><button id = "addTaskOpen">Add task</button><br>',L=document.getElementById("addTaskOpen"),f=document.querySelectorAll(".checkbox"),T=document.querySelectorAll(".taskDate"),E=document.getElementById("addTaskContainer"),p=document.getElementById("cancelAddTask"),v=document.getElementById("addTask"),y=document.getElementById("newTaskName"),q(),L.addEventListener("click",(()=>{E.classList.remove("hidden"),L.classList.add("hidden")})),v.addEventListener("click",(()=>{if(y.value){let t=y.value,s=document.getElementById("projectTitle").innerText;for(let n=0;n<g.getList().length;n++)if(s==g.getList()[n].name){let s=new e(t);g.getList()[n].tasks.push(s),g.setStorage(),k=document.getElementById("taskContainer"),N(g.getList()[n]),x(g.getList()[n]),q()}w()}})),p.addEventListener("click",(()=>{w()})),x(s)}function N(e){console.log("display"),k.innerHTML="",e.tasks.forEach((e=>{k.innerHTML+=`<div class = "taskCell"><div class = "nameAndCheck"><input class = "checkbox" type = "checkbox" id = "${e.name}">\n        <p class = "taskName">`+e.name+'</p></div><div class = "taskDateContainer">'+`<p id = "${e.name}Date" class = "taskDate">`+e.date+"</p></div>"})),f=document.querySelectorAll(".checkbox"),x(e)}function A(e){for(let t=0;t<g.getList().length;t++)if(e==g.getList()[t].name)return g.getList()[t]}function C(){a.innerHTML="",a.innerHTML+="<h2 id = 'projectTitle'>Today</h2><div id = 'taskContainer'></div>",k=document.getElementById("taskContainer"),function(){let e=(new Date).toJSON().slice(0,10),n=new t("today");for(let t=0;t<g.getList().length;t++){let a=g.getList()[t];for(let t=0;t<a.tasks.length;t++)if(a.tasks[t].date==e){let e=new s(a.tasks[t].name,a.name,a.tasks[t].date);n.addTask(e)}}return n}().getTasks().forEach((e=>{k.innerHTML+=`<div class = "taskCell"><div class = "nameAndCheck"><input class = "checkbox" type = "checkbox" id = "${e.name}-${e.projectName}">\n        <p class = "taskName">`+e.name+`(${e.projectName})</p></div><div class = "taskDateContainer">`+`<p id = "${e.name}Date" class = "taskDate">`+e.date+"</p></div>"})),f=document.querySelectorAll(".checkbox"),q(),f.forEach((e=>{e.addEventListener("click",(()=>{let s=e.id,n=s.split("-")[0],a=s.split("-")[1],d=A(a),i=new t(a);i.setTasks(d.tasks),i.deleteTask(n),D(i),C()}))}))}function x(e){f.forEach((s=>{s.addEventListener("click",(()=>{let n=new t(e.name);n.setTasks(e.tasks);let a=s.id;n.deleteTask(a),e.tasks=n.getTasks(),D(e),b(e.name)}))}))}function D(e){g.getList().forEach((t=>{t.name==e.name&&(N(t=e),console.log(t))})),g.setStorage()}function q(){T=document.querySelectorAll(".taskDate"),T.forEach((e=>{e.addEventListener("click",(()=>{console.log("dateClick");let t=document.createElement("input");t.classList.add("dateInput"),t.id=e.id,t.type="date",e.parentNode.replaceChild(t,e),I=document.getElementById("projectTitle"),function(e){let t=document.querySelector(".dateInput");t.addEventListener("change",(()=>{let s=new Date(t.value),n=t.id;n=n.slice(0,-4),s instanceof Date&&!isNaN(s.valueOf())&&(function(e,t,s){e.tasks.forEach((n=>{n.name==t&&(n.date=s,D(e))}))}(e,n,t.value),b(e.name),console.log(e))}))}(A(I.innerText))}))}))}function w(){E.classList.add("hidden"),L.classList.remove("hidden")}null!=localStorage.getItem("projects")&&g.getStorage(),null!=g.getList()&&B(),b("Inbox");let P=[...i,...h];var H;(H=P).forEach((e=>{e.addEventListener("click",(()=>{H.forEach((e=>{e.classList.remove("pressed")})),e.classList.add("pressed")}))})),n.addEventListener("click",(()=>{a.innerText="",b("Inbox")})),r.addEventListener("click",(()=>{o.classList.remove("hidden"),r.classList.add("hidden")})),m.addEventListener("click",(()=>{o.classList.add("hidden"),r.classList.remove("hidden")})),l.addEventListener("click",(()=>{!function(e){let s=new t(e);g.addProject(s),g.setStorage(),g.getStorage(),B()}(u.value),g.getStorage(),B()}));for(let e=0;e<h.length;e++)h[e].addEventListener("click",(()=>{b(h[e].id)}));S.addEventListener("click",(()=>{C()}))})();